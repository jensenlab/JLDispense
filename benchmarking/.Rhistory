LCL=mu0-L*sdw
p1=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
data=data.frame(mu,p1,p2,p3,p4)
plt1=ggplot2::ggplot(data=data)+
geom_line(aes(mu,p1))+
geom_line(aes(mu,p2))+
geom_line(aes(mu,p3),color=red)+
geom_line(aes(mu,p4))+
annotate("text",x=mu0+0.25,y=0.25, label="L=1")+
annotate("text",x=mu0+0.37,y=0.45,label="L=2")+
annotate("text",x=mu0+0.5,y=0.60,label="L=3")+
annotate("text",x=mu0+.65,y=0.7,label="L=4")+
ylab("Proabability of no alarm")+
xlab("Size of mean shift")+
theme_classic()
plt1
L=3
n=2
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p3=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
n=4
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p2=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
n=8
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p4=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
n=16
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p1=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
data=data.frame(mu,p1,p2,p3,p4)
plt2=ggplot2::ggplot(data=data)+
geom_line(aes(mu,p1))+
geom_line(aes(mu,p2),color=red)+
geom_line(aes(mu,p3))+
geom_line(aes(mu,p4))+
annotate("text",x=mu0+0.25,y=0.25, label="n=16")+
annotate("text",x=mu0+0.37,y=0.45,label="n=8")+
annotate("text",x=mu0+0.5,y=0.60,label="n=4")+
annotate("text",x=mu0+0.65,y=0.7,label="n=2")+
ylab("Proabability of no alarm")+
xlab("Size of mean shift")+
theme_classic()
plt2
ggsave(paste(basepath,"OC_L.pdf",sep=""),plt1,width=4,height=3)
ggsave(paste(basepath,"OC_n.pdf",sep=""),plt2,width=4,height=3)
library(ggplot2)
library(dplyr)
library(latex2exp)
blue <- "#2c7bb6"
red <- "#d7191c"
mu=seq(0,1,0.01)
mu0=0
sd=0.4
sdw=sd/sqrt(n)
n=4
L=3
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p3=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
L=2
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p2=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
L=4
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p4=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
L=1
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p1=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
data=data.frame(mu,p1,p2,p3,p4)
plt1=ggplot2::ggplot(data=data)+
geom_line(aes(mu,p1))+
geom_line(aes(mu,p2))+
geom_line(aes(mu,p3),color=red)+
geom_line(aes(mu,p4))+
annotate("text",x=mu0+0.25,y=0.25, label="L=1")+
annotate("text",x=mu0+0.37,y=0.45,label="L=2")+
annotate("text",x=mu0+0.5,y=0.60,label="L=3")+
annotate("text",x=mu0+.65,y=0.7,label="L=4")+
ylab("Proabability of a point plotting \n between the control limits")+
xlab("Size of mean shift")+
theme_classic()
plt1
L=3
n=2
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p3=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
n=4
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p2=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
n=8
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p4=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
n=16
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p1=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
data=data.frame(mu,p1,p2,p3,p4)
plt2=ggplot2::ggplot(data=data)+
geom_line(aes(mu,p1))+
geom_line(aes(mu,p2),color=red)+
geom_line(aes(mu,p3))+
geom_line(aes(mu,p4))+
annotate("text",x=mu0+0.25,y=0.25, label="n=16")+
annotate("text",x=mu0+0.37,y=0.45,label="n=8")+
annotate("text",x=mu0+0.5,y=0.60,label="n=4")+
annotate("text",x=mu0+0.65,y=0.7,label="n=2")+
ylab("Proabability of no alarm")+
xlab("Size of mean shift")+
theme_classic()
plt2
ggsave(paste(basepath,"OC_L.pdf",sep=""),plt1,width=4,height=3)
ggsave(paste(basepath,"OC_n.pdf",sep=""),plt2,width=4,height=3)
library(ggplot2)
library(dplyr)
library(latex2exp)
blue <- "#2c7bb6"
red <- "#d7191c"
mu=seq(0,1,0.01)
mu0=0
sd=0.4
sdw=sd/sqrt(n)
n=4
L=3
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p3=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
L=2
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p2=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
L=4
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p4=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
L=1
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p1=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
data=data.frame(mu,p1,p2,p3,p4)
plt1=ggplot2::ggplot(data=data)+
geom_line(aes(mu,p1))+
geom_line(aes(mu,p2))+
geom_line(aes(mu,p3),color=red)+
geom_line(aes(mu,p4))+
annotate("text",x=mu0+0.25,y=0.25, label="L=1")+
annotate("text",x=mu0+0.37,y=0.45,label="L=2")+
annotate("text",x=mu0+0.5,y=0.60,label="L=3")+
annotate("text",x=mu0+.65,y=0.7,label="L=4")+
ylab("Proabability of a point plotting \n between the control limits")+
xlab("Size of mean shift")+
theme_classic()
plt1
L=3
n=2
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p3=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
n=4
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p2=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
n=8
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p4=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
n=16
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p1=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
data=data.frame(mu,p1,p2,p3,p4)
plt2=ggplot2::ggplot(data=data)+
geom_line(aes(mu,p1))+
geom_line(aes(mu,p2),color=red)+
geom_line(aes(mu,p3))+
geom_line(aes(mu,p4))+
annotate("text",x=mu0+0.25,y=0.25, label="n=16")+
annotate("text",x=mu0+0.37,y=0.45,label="n=8")+
annotate("text",x=mu0+0.5,y=0.60,label="n=4")+
annotate("text",x=mu0+0.65,y=0.7,label="n=2")+
ylab("Proabability of a point plotting \n between the control limits")+
xlab("Size of mean shift")+
theme_classic()
plt2
ggsave(paste(basepath,"OC_L.pdf",sep=""),plt1,width=4,height=3)
ggsave(paste(basepath,"OC_n.pdf",sep=""),plt2,width=4,height=3)
plt1a =ggplot2::ggplot((data=data))+
plt1=ggplot2::ggplot(data=data)+
geom_line(aes(mu,1/p1))+
geom_line(aes(mu,1/p2))+
geom_line(aes(mu,1/p3),color=red)+
geom_line(aes(mu,1/p4))+
#annotate("text",x=mu0+0.25,y=0.25, label="L=1")+
#annotate("text",x=mu0+0.37,y=0.45,label="L=2")+
#annotate("text",x=mu0+0.5,y=0.60,label="L=3")+
#annotate("text",x=mu0+.65,y=0.7,label="L=4")+
ylab("Proabability of a point plotting \n between the control limits")+
xlab("Size of mean shift")+
theme_classic()
library(ggplot2)
library(dplyr)
library(latex2exp)
blue <- "#2c7bb6"
red <- "#d7191c"
mu=seq(0,1,0.01)
mu0=0
sd=0.4
sdw=sd/sqrt(n)
n=4
L=3
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p3=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
L=2
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p2=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
L=4
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p4=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
L=1
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p1=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
data=data.frame(mu,p1,p2,p3,p4)
plt1=ggplot2::ggplot(data=data)+
geom_line(aes(mu,p1))+
geom_line(aes(mu,p2))+
geom_line(aes(mu,p3),color=red)+
geom_line(aes(mu,p4))+
annotate("text",x=mu0+0.25,y=0.25, label="L=1")+
annotate("text",x=mu0+0.37,y=0.45,label="L=2")+
annotate("text",x=mu0+0.5,y=0.60,label="L=3")+
annotate("text",x=mu0+.65,y=0.7,label="L=4")+
ylab("Proabability of a point plotting \n between the control limits")+
xlab("Size of mean shift")+
theme_classic()
plt1
plt1a =ggplot2::ggplot((data=data))+
plt1=ggplot2::ggplot(data=data)+
geom_line(aes(mu,1/p1))+
geom_line(aes(mu,1/p2))+
geom_line(aes(mu,1/p3),color=red)+
geom_line(aes(mu,1/p4))+
#annotate("text",x=mu0+0.25,y=0.25, label="L=1")+
#annotate("text",x=mu0+0.37,y=0.45,label="L=2")+
#annotate("text",x=mu0+0.5,y=0.60,label="L=3")+
#annotate("text",x=mu0+.65,y=0.7,label="L=4")+
ylab("Proabability of a point plotting \n between the control limits")+
xlab("Size of mean shift")+
theme_classic()
plt1a =ggplot2::ggplot((data=data))+
geom_line(aes(mu,1/p1))+
geom_line(aes(mu,1/p2))+
geom_line(aes(mu,1/p3),color=red)+
geom_line(aes(mu,1/p4))+
#annotate("text",x=mu0+0.25,y=0.25, label="L=1")+
#annotate("text",x=mu0+0.37,y=0.45,label="L=2")+
#annotate("text",x=mu0+0.5,y=0.60,label="L=3")+
#annotate("text",x=mu0+.65,y=0.7,label="L=4")+
ylab("Proabability of a point plotting \n between the control limits")+
xlab("Size of mean shift")+
theme_classic()
plt1a
plt1a =ggplot2::ggplot((data=data))+
geom_line(aes(mu,1/p1))+
geom_line(aes(mu,1/p2))+
geom_line(aes(mu,1/p3),color=red)+
#geom_line(aes(mu,1/p4))+
#annotate("text",x=mu0+0.25,y=0.25, label="L=1")+
#annotate("text",x=mu0+0.37,y=0.45,label="L=2")+
#annotate("text",x=mu0+0.5,y=0.60,label="L=3")+
#annotate("text",x=mu0+.65,y=0.7,label="L=4")+
ylab("Proabability of a point plotting \n between the control limits")+
xlab("Size of mean shift")+
theme_classic()
plt1a
library(ggplot2)
library(dplyr)
library(latex2exp)
blue <- "#2c7bb6"
red <- "#d7191c"
mu=seq(0,1,0.01)
mu0=0
sd=0.4
sdw=sd/sqrt(n)
n=4
L=3
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p3=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
L=2
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p2=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
L=4
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p4=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
L=1
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p1=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
data=data.frame(mu,p1,p2,p3,p4)
plt1=ggplot2::ggplot(data=data)+
geom_line(aes(mu,p1))+
geom_line(aes(mu,p2))+
geom_line(aes(mu,p3),color=red)+
geom_line(aes(mu,p4))+
annotate("text",x=mu0+0.25,y=0.25, label="L=1")+
annotate("text",x=mu0+0.37,y=0.45,label="L=2")+
annotate("text",x=mu0+0.5,y=0.60,label="L=3")+
annotate("text",x=mu0+.65,y=0.7,label="L=4")+
ylab("Proabability of a point plotting \n between the control limits")+
xlab("Size of mean shift")+
theme_classic()
plt1
L=3
n=2
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p3=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
n=4
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p2=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
n=8
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p4=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
n=16
sdw=sd/sqrt(n)
UCL=mu0+L*sdw
LCL=mu0-L*sdw
p1=pnorm((UCL-mu)/sdw)-pnorm((LCL-mu)/sdw)
data=data.frame(mu,p1,p2,p3,p4)
plt2=ggplot2::ggplot(data=data)+
geom_line(aes(mu,p1))+
geom_line(aes(mu,p2),color=red)+
geom_line(aes(mu,p3))+
geom_line(aes(mu,p4))+
annotate("text",x=mu0+0.25,y=0.25, label="n=16")+
annotate("text",x=mu0+0.37,y=0.45,label="n=8")+
annotate("text",x=mu0+0.5,y=0.60,label="n=4")+
annotate("text",x=mu0+0.65,y=0.7,label="n=2")+
ylab("Proabability of a point plotting \n between the control limits")+
xlab("Size of mean shift")+
theme_classic()
plt2
ggsave(paste(basepath,"OC_L.pdf",sep=""),plt1,width=4,height=3)
ggsave(paste(basepath,"OC_n.pdf",sep=""),plt2,width=4,height=3)
pnorm(4)-pnorm(-2)
x=1-(pnorm(4)-pnorm(-2))
x
1/x
x1=c(-1,-1,1,1,0,0,0)
x2=c(-1,1,-1,1,0,0,0)
y=c(39.3,40,40.9,41.5,40.3,40.5,40.7)
data=data.frame(x1,x2,y)
mdl=lm(y~x1+x2,data=data)
summary(mdl)
predict(mdl,c(0,0))
predict(mdl,x=data.framec(0,0))
mean(y[1:4])
pnorm(3)
## plot the temperature of plate example
library(ggplot2)
d=data.frame(x,y)
x=c(3,602,1217,1805)
y=c(0.31,0.32,0.43,0.58)
d=data.frame(x,y)
plt2=ggplot(data=d)+
geom_point(aes(x,y))+
them_classic()
x=c(3,602,1217,1805)
y=c(0.31,0.32,0.43,0.58)
d=data.frame(x,y)
plt2=ggplot(data=d)+
geom_point(aes(x,y))+
theme_classic()
plt2
x=c(3,602,1217,1805)/60
y=c(0.31,0.32,0.43,0.58)
d=data.frame(x,y)
plt2=ggplot(data=d)+
geom_point(aes(x,y))+
theme_classic()+
ylim(c(0.2,0.6))+
scale_x_continuous()
plt2
d=data.frame(x,y)
plt2=ggplot(data=d)+
geom_point(aes(x,y))+
theme_classic()+
ylim(c(0.2,0.6))+
xlab("Machine Time (min)")+
ylab("OD600")
plt2
x=c(3,602,1217,1805)/60
y=c(0.31,0.32,0.43,0.58)
d=data.frame(x,y)
plt2=ggplot(data=d)+
geom_point(aes(x,y))+
theme_classic()+
ylim(c(0.2,0.6))+
xlab("Machine Time (min)")+
ylab("OD600")
plt2
ggsave("/Users/BDavid/Dropbox (University of Michigan)/Apps/Overleaf/Benjamin David PhD Thesis/figures/CHESS/read_timeseries.png",plt,width=2.5 ,height= 2.5 )
ggsave("/Users/BDavid/Dropbox (University of Michigan)/Apps/Overleaf/Benjamin David PhD Thesis/figures/CHESS/read_timeseries.png",plt2,width=2.5 ,height= 2.5 )
setwd("~/Documents/GitHub/JLDispense/benchmarking")
library(ggplot2)
data = read.csv("benchmark.csv")
data= data[data$time<800,]
insts=c("P-200","P-100 Multichannel","PlateMaster","Nimbus","Cobra")
pistons=c(1,1,1,1,4)
channels=c(1,8,96,1,4)
piston_dict= as.list(setNames(pistons,insts))
channel_dict= as.list(setNames(channels,insts))
piston_vals=rep(0,nrow(data))
channel_vals=rep(0,nrow(data))
for (i in 1:nrow(data)){
instruments = data$instruments[i]
instruments = as.vector(strsplit(instruments,","))
p = 0
c=0
for (inst in instruments[[1]]){
p = p + piston_dict[inst][[1]]
c = c + channel_dict[inst][[1]]
}
piston_vals[i]= p
channel_vals[i]=c
}
data$pistons= piston_vals
data$channels=channel_vals
model <- lm(time ~ I(wells^2)*I(pistons^2),data=data)
summary(model)
data$pistons = piston_vals
qqnorm(data$time)
setwd("~/Documents/GitHub/JLDispense/benchmarking")
library(ggplot2)
data = read.csv("benchmark.csv")
#data= data[data$time<800,]
insts=c("P-200","P-100 Multichannel","PlateMaster","Nimbus","Cobra")
pistons=c(1,1,1,1,4)
channels=c(1,8,96,1,4)
piston_dict= as.list(setNames(pistons,insts))
channel_dict= as.list(setNames(channels,insts))
piston_vals=rep(0,nrow(data))
channel_vals=rep(0,nrow(data))
for (i in 1:nrow(data)){
instruments = data$instruments[i]
instruments = as.vector(strsplit(instruments,","))
p = 0
c=0
for (inst in instruments[[1]]){
p = p + piston_dict[inst][[1]]
c = c + channel_dict[inst][[1]]
}
piston_vals[i]= p
channel_vals[i]=c
}
data$pistons= piston_vals
data$channels=channel_vals
model <- lm(time ~ I(wells^2)*I(pistons^2),data=data)
summary(model)
data$pistons = piston_vals
plot(model)
plot(model)
max(data$time)
2560/60
